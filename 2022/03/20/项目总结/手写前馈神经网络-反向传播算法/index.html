<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>












    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            反向传播算法，手动实现前馈神经网络 | 
        
        Moonglade
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon_io_c/favicon-32x32.png">
    <link rel="icon" href="/img/favicon_io_c/android-chrome-512x512.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/tranquil-heart.min.css?ul3p9I9MsbOxK0L+BHzDDg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        background-color: ;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Moonglade">
    <meta name="msapplication-starturl" content="http://example.com/2022/03/20/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E6%89%8B%E5%86%99%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Moonglade">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon_io_c/apple-touch-icon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://example.com/2022/03/20/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E6%89%8B%E5%86%99%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="反向传播算法，手动实现前馈神经网络 | Moonglade">
    <meta property="og:image" content="/img/favicon_io_c/android-chrome-512x512.png">
    <meta property="og:description" content="">
    

    
        <meta property="article:published_time" content="Sun Mar 20 2022 13:13:29 GMT+0800">
        <meta property="article:modified_time" content="Mon Mar 21 2022 23:46:15 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://example.com/2022/03/20/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E6%89%8B%E5%86%99%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/index.html" />
    

    <!-- Structured-data for SEO -->
    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 6.0.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95"><span class="post-toc-number">1.</span> <span class="post-toc-text">反向传播算法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%90%86%E8%A7%A3"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">理解</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%AC%A6%E5%8F%B7"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">符号</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%9A%84%E5%9B%9B%E4%B8%AA%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%E5%BC%8F%E5%92%8C%E8%AF%81%E6%98%8E"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">反向传播的四个基本方程式和证明</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-%E8%BE%93%E5%87%BA%E5%B1%82%E7%9A%84%E8%AF%AF%E5%B7%AE-delta-L-j-%EF%BC%9A"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">1. 输出层的误差$\delta^L_j$：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-%E4%BD%BF%E7%94%A8%E4%B8%8B%E4%B8%80%E5%B1%82%E7%9A%84%E8%AF%AF%E5%B7%AE-delta-l-1-%E6%9D%A5%E8%A1%A8%E7%A4%BA%E5%BD%93%E5%89%8D%E5%B1%82%E7%9A%84%E8%AF%AF%E5%B7%AE-delta-l"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">2. 使用下一层的误差$\delta^{l+1}$来表示当前层的误差$\delta^l:$</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0-delta-l-j-%E5%85%B3%E4%BA%8E%E7%BD%91%E7%BB%9C%E4%B8%AD%E4%BB%BB%E6%84%8F%E5%81%8F%E7%BD%AE-frac-partial-C-partial-b-l-j-%E6%94%B9%E5%8F%98%E7%8E%87%EF%BC%9A"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">3. 代价函数$\delta^l_j$关于网络中任意偏置$\frac{\partial C}{\partial b^l_j}$改变率：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0-delta-l-j-%E5%85%B3%E4%BA%8E%E4%BB%BB%E4%BD%95%E2%BC%80%E4%B8%AA%E6%9D%83%E9%87%8D-frac-partial-C-partial-w-l-jk-%E7%9A%84%E6%94%B9%E5%8F%98%E7%8E%87%EF%BC%9A"><span class="post-toc-number">1.3.4.</span> <span class="post-toc-text">4. 代价函数$\delta^l_j$关于任何⼀个权重$\frac{\partial C}{\partial w^l_{jk}}$的改变率：</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="post-toc-number">2.</span> <span class="post-toc-text">手动实现前馈神经网络</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B1%82%E5%AF%BC"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">求导</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#NLLLoss"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">NLLLoss</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Log"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">Log</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Softmax"><span class="post-toc-number">2.1.3.</span> <span class="post-toc-text">Softmax</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#FFN"><span class="post-toc-number">2.1.4.</span> <span class="post-toc-text">FFN</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ReLU"><span class="post-toc-number">2.1.5.</span> <span class="post-toc-text">ReLU</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#python%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">python代码实现</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                反向传播算法，手动实现前馈神经网络
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/favicon_io/android-chrome-512x512.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>MorphLing</strong>
        <span>3月 20, 2022</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=反向传播算法，手动实现前馈神经网络&url=http://example.com/2022/03/20/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E6%89%8B%E5%86%99%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/index.html&pic=http://example.com/img/favicon_io_c/favicon-32x32.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=反向传播算法，手动实现前馈神经网络&url=http://example.com/2022/03/20/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E6%89%8B%E5%86%99%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/index.html&via=MorphLing" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2022/03/20/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E6%89%8B%E5%86%99%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://example.com/2022/03/20/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E6%89%8B%E5%86%99%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>其实没那么难的，就是讲人话的资料太难找，知乎和CSDN把我看自闭了。</p>
<p>反向传播部分推荐一下<a target="_blank" rel="noopener" href="http://neuralnetworksanddeeplearning.com/">Neural Network and Deep Learning</a>第二章<a target="_blank" rel="noopener" href="http://neuralnetworksanddeeplearning.com/chap2.html">How the backpropagation algorithm works</a>，写得真的很不错，应该很容易找到对应的中文版pdf。</p>
<h2 id="反向传播算法"><a href="#反向传播算法" class="headerlink" title="反向传播算法"></a>反向传播算法</h2><h3 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h3><p>很多讲反向传播算法的文章一上来就开始说链式法则，然后就是一大堆符号下标的公式推导。的确链式法则是反向传播算法的核心，只要能理解利用链式法则的推导过程基本等同于理解了反向传播算法。但这种方法是有门槛的，尤其是对于我这种对导数、梯度等概念理解不够深刻的人来说，一旦推不下去很容易就陷入一种困境。</p>
<p>所以，先给出几个直观的理解，不一定准确严谨，只是我自己的一些感性理解：</p>
<ol>
<li><p>什么叫反向传播：我们用损失函数度量网络模型结果的好坏，但是损失函数得到的值是一个标量，或者说这个值只停留在网络中最后输出层的那一个节点上。我们需要先把这个标量误差<strong>反向传播</strong>到网络中的每一个节点上，如何传播呢？能作为传播载体的只能是网络本身，也就是层与层之间的权重矩阵。误差也一定附着在神经元上，每个神经元都有一个对应的误差。</p>
</li>
<li><p>怎么理解误差：误差按照<strong>输出层$L\rightarrow$输入层$1$</strong>的顺序反向传播，但是<strong>当前层的误差</strong>应当理解成<strong>输入层$1\rightarrow$当前层$l$</strong>在传播过程中产生的误差。所以反向传播中的<strong>反向</strong>指的是<strong>计算方式</strong>上的反向，实际上误差应当是在<strong>正向传播</strong>过程中造成的，这里正向和反向似乎很容易混淆。</p>
</li>
<li><p>误差和偏导数的关系：既然认识到误差是正向传播造成的，那么就可以把某个节点上的误差理解成<strong>多个上一层节点误差的结合</strong>。求偏导就是为了找到每个<strong>上一层节点</strong>对这个误差的贡献，说白了就是分锅，看看在造成误差这个事情上，上层节点中每个节点的锅分别有多大。</p>
<p>举个例子，节点$z$的误差为$\delta(z)=0a_1+5a_2+1000a_3$，把$a_1,a_2,a_3$是$z$的三个上层节点的输出，那么三个节点中，误差主要由$a_3$对应的节点造成，与$a_1$对应的节点完全无关。所以在反向传播中，此时$a_1$对应的节点传播过去的误差为0，$a_3$对应的节点传播过去的误差最大。$\frac{\partial z}{\partial a_1}$和$\frac{\partial z}{\partial a_3}$可以刻画这个大小。</p>
</li>
<li><p>理解反向传播是一个递推过程：现在回到输出层$L\rightarrow$输入层$1$的<strong>反向</strong>传播过程中，在反向传播计算得到当前层每个神经元的误差后，先前计算过的层就不再需要了，因为所有信息都被记录在了误差这个<strong>状态</strong>里。反向传播的过程中只需要关注当前层$l$和上一层$l-1$这两层神经元，以及两层之间的权重矩阵，这是一个递推的过程。</p>
</li>
<li><p>如何更新权重：现在问题被限制在<strong>两层之间</strong>，在当前层$l$的误差$\delta^l$的基础上，求误差关于权重的偏导数，并根据偏导数调整权重即可，类似于第三点举的例子$\delta(z)=0a_1+5a_2+1000a_3$，只不过此时$0、5、1000$不再是常数，而是被替换成$w_1,w_2,w_3$，只要根据$\frac{\partial \delta(z)}{\partial w}$使$w$沿梯度方向下降。</p>
</li>
</ol>
<h3 id="符号"><a href="#符号" class="headerlink" title="符号"></a>符号</h3><ul>
<li><p>$w^l:$第$l$层的权重矩阵，这里用$w^l_{jk}$表示从$l-1$层的第$k$个神经元到$l$层的第$j$个神经元的连接上的权重</p>
<p><img src="https://morphling-picgo.oss-cn-shanghai.aliyuncs.com/202203210123254.png" alt="image-20220321012346133"></p>
</li>
<li><p>$b^l:$第$l$层的偏置向量</p>
</li>
<li><p>$\sigma(·):$激活函数</p>
</li>
<li><p>$a^l:$第$l$层神经元的激活值，有递推关系：</p>
<script type="math/tex; mode=display">
a^l=\sigma(w^la^{l-1}+b^l)</script></li>
<li><p>$z^l:$第$l$层神经元的中间量或者叫<strong>带权输入</strong>：</p>
<script type="math/tex; mode=display">
z^l_j=\sum\limits_kw^{l-1}_{jk}a^{l-1}_k+b^l_j\\</script><p>需要特别注意是$a^{l-1}_k\rightarrow z^l_j$对应的权重是$w^{l-1}_{jk}$而不是$w^{l-1}_{kj}$，这可能有点反直觉，但可能只有这样才能符合列向量的表示。</p>
<p>也就是式子应写成$Z=WA+B$的形式，其中$Z,A,B$都是列向量，否则如果只能写成$Z=AW+B$，那么$Z,A,B$都是行向量。这个区别很可能会在代码实现的过程中造成困惑，所以提前说明。</p>
<p>矩阵形式：</p>
<script type="math/tex; mode=display">
z^l=w^la^{l-1}+b^l</script></li>
<li><p>$C:$代价函数，由输出层的激活值向量$a^L$计算得出，例如：</p>
<script type="math/tex; mode=display">
C=\frac{1}{2n}\sum\limits_x\|y(x)-a^L(x)\|^2</script></li>
<li><p>$\delta^l_j:$定义在$l$层的第$j^{th}$个神经元上的误差：</p>
<script type="math/tex; mode=display">
\delta^l_j=\frac{\partial C}{\partial z^l_j}</script><p>为什么可以启发式认为$\frac{\partial C}{\partial z^l_j}$是神经元误差的度量呢，假设我们可以对$z^l_j$进行一个很小的扰动，使神经元输出由$\sigma(z^l_j)$变成$\sigma(z^l_j+\Delta z^l_j)$，那么这个扰动会向后传播，最终导致整个代价产生$\frac{\partial C}{\partial z^l_j}\Delta z^l_j$的改变。那么当$\frac{\partial C}{\partial z^l_j}$有一个很大的值（无论正负），我们可以调整这个扰动$\Delta z^l_j$的符号来降低代价；相反如果$\frac{\partial C}{\partial z^l_j}$接近0，很难通过扰动来改善代价，这时候神经元已经接近最优了。这是一种启发式的认识，表明$\frac{\partial C}{\partial z^l_j}$是神经元的误差的度量。</p>
</li>
</ul>
<h3 id="反向传播的四个基本方程式和证明"><a href="#反向传播的四个基本方程式和证明" class="headerlink" title="反向传播的四个基本方程式和证明"></a>反向传播的四个基本方程式和证明</h3><h4 id="1-输出层的误差-delta-L-j-："><a href="#1-输出层的误差-delta-L-j-：" class="headerlink" title="1. 输出层的误差$\delta^L_j$："></a>1. <strong>输出层的误差$\delta^L_j$：</strong></h4><script type="math/tex; mode=display">
   \delta^L_j=\frac{\partial C}{\partial a^L_j}\sigma'(z^L_j)</script><p>   <strong>矩阵形式：</strong></p>
<script type="math/tex; mode=display">
   \delta^L=\nabla_aC\odot \sigma'(z^L)</script><p>   其中$\odot$表示Hadamard乘积，表示两个维度相同的向量对应位置相乘。</p>
<p>   <strong>证明</strong>：由定义$\delta_j^L=\frac{\partial C}{\partial z^l_j}$，<strong>由链式法则，如果函数和参数之间有多条路径，应将多条路径上的导数进行相加得到最终的梯度</strong>，即</p>
<script type="math/tex; mode=display">
   \frac{\partial C}{\partial z^L_j}=\sum\limits_k\frac{\partial C}{\partial a^L_k}\frac{\partial a^L_k}{\partial z^L_j}</script><p>   当$k\ne j$时$\frac{\partial a^L_k}{\partial z^L_j}=0$（$a^L_i$只和$z^L_i$有关），所以</p>
<script type="math/tex; mode=display">
   \frac{\partial C}{\partial z^L_j}=\frac{\partial C}{\partial a^L_j}\frac{\partial a^L_j}{\partial z^L_j}=\frac{\partial C}{\partial a^L_j}\sigma'(z^L_j)</script><h4 id="2-使用下一层的误差-delta-l-1-来表示当前层的误差-delta-l"><a href="#2-使用下一层的误差-delta-l-1-来表示当前层的误差-delta-l" class="headerlink" title="2. 使用下一层的误差$\delta^{l+1}$来表示当前层的误差$\delta^l:$"></a>2. <strong>使用下一层的误差$\delta^{l+1}$来表示当前层的误差$\delta^l:$</strong></h4><script type="math/tex; mode=display">
\delta^l=((w^{l+1})^T\delta^{(l+1)})\odot\sigma'(z^l)</script><p>   <strong>理解</strong>：误差沿着网络反向移动。</p>
<p>   <strong>证明</strong>：</p>
<script type="math/tex; mode=display">
   \delta^l_j=\frac{\partial C}{\partial z^l_j}\\
    =\sum\limits_k\frac{\partial C}{\partial z^{l+1}_k}\frac{\partial z^{l+1}_k}{\partial z^l_j}\\
    =\sum\limits_k\frac{\partial z^{l+1}_k}{\partial z^l_j}\delta^{l+1}_k</script><p>   $z^{l+1}_k$是第$l+1$层的带权输入：</p>
<script type="math/tex; mode=display">
   z^{l+1}_k=\sum\limits_j w^{l+1}_{kj}a^l_j+b^{l+1}_k=\sum\limits_jw^{l+1}_{kj}\sigma(z^l_j)+b^{l+1}_k</script><p>   所以$z^{l+1}_k$对$z^l_j$求导结果：</p>
<script type="math/tex; mode=display">
   \frac{\partial z^{l+1}_k}{\partial z^l_j}=w^{l+1}_{kj}\sigma'(z^l_j)</script><p>   代入上式得到：</p>
<script type="math/tex; mode=display">
   \delta^l_j=\sum\limits_kw^{l+1}_{kj}\delta^{l+1}_k\sigma'(z^l_j)</script><p>   从分量形式改写成<strong>矩阵形式</strong>，得到结论：</p>
<script type="math/tex; mode=display">
\delta^l=((w^{l+1})^T\delta^{(l+1)})\odot\sigma'(z^l)</script><h4 id="3-代价函数-delta-l-j-关于网络中任意偏置-frac-partial-C-partial-b-l-j-改变率："><a href="#3-代价函数-delta-l-j-关于网络中任意偏置-frac-partial-C-partial-b-l-j-改变率：" class="headerlink" title="3. 代价函数$\delta^l_j$关于网络中任意偏置$\frac{\partial C}{\partial b^l_j}$改变率："></a>3. <strong>代价函数$\delta^l_j$关于网络中任意偏置$\frac{\partial C}{\partial b^l_j}$改变率：</strong></h4><script type="math/tex; mode=display">
   \frac{\partial C}{\partial b^l_j}=\delta^l_j</script><p>   <strong>证明：</strong></p>
<p>   由链式法则：</p>
<script type="math/tex; mode=display">
   \frac{\partial C}{\partial b^l_j}=\sum\limits_k\frac{\partial z^l_k}{\partial b^l_j}\frac{\partial C}{\partial z^l_k}\\
   =\sum\limits_k\frac{\partial z^l_k}{\partial b^l_j}\delta^l_k</script><p>   和上面一样，由于：</p>
<script type="math/tex; mode=display">
   z^l_k=\sum\limits_jw^l_{kj}a^{l-1}_j+b^l_k</script><p>   所以</p>
<script type="math/tex; mode=display">
   \frac{\partial z^l_k}{\partial b^l_j}=
   \left\{
   \begin{array}{}

   0,\quad k\ne j\\
   1,\quad k =j
   \end{array}
   \right.
   \\</script><p>   代入上式得到结论：</p>
<script type="math/tex; mode=display">
\frac{\partial C}{\partial b^l_j}=\delta^l_j</script><h4 id="4-代价函数-delta-l-j-关于任何⼀个权重-frac-partial-C-partial-w-l-jk-的改变率："><a href="#4-代价函数-delta-l-j-关于任何⼀个权重-frac-partial-C-partial-w-l-jk-的改变率：" class="headerlink" title="4. 代价函数$\delta^l_j$关于任何⼀个权重$\frac{\partial C}{\partial w^l_{jk}}$的改变率："></a>4. <strong>代价函数$\delta^l_j$关于任何⼀个权重$\frac{\partial C}{\partial w^l_{jk}}$的改变率：</strong></h4><script type="math/tex; mode=display">
\frac{\partial C}{\partial w^l_{jk}}=a^{l-1}_k\delta^l_j\\</script><p>   <strong>证明：</strong></p>
<p>   这里符号会复杂一点，但问题的本质是不变的，只是更加仔细地使用链式法则。</p>
<p>   由链式法则：</p>
<script type="math/tex; mode=display">
\frac{\partial C}{\partial w^l_{jk}}=\sum\limits_p\frac{\partial z^l_p}{\partial w^l_{jk}}\frac{\partial C}{\partial z^l_p}\\
   =\sum\limits_p\frac{\partial z^l_p}{\partial w^l_{jk}}\delta^l_p</script><p>   由于：</p>
<script type="math/tex; mode=display">
z^l_p=\sum\limits_qw^l_{pq}a^{l-1}_q+b^l_q</script><p>   所以$z^l_p$对$w^l_{jk}$求偏导：</p>
<script type="math/tex; mode=display">
\frac{\partial z^l_p}{\partial w^l_{jk}}=
   \left\{
   \begin{array}{}

   0,\quad p\ne j\\
   a^{l-1}_k,\quad p=j
   \end{array}
   \right.
   \\</script><p>   代入上式得到结论：</p>
<script type="math/tex; mode=display">
\frac{\partial C}{\partial w^l_{jk}}=a^{l-1}_k\delta^l_j</script><p>   <strong>矩阵形式：</strong> </p>
<script type="math/tex; mode=display">
\frac{\partial C}{\partial w}=\delta_{out}(a_{in})^T</script><h2 id="手动实现前馈神经网络"><a href="#手动实现前馈神经网络" class="headerlink" title="手动实现前馈神经网络"></a>手动实现前馈神经网络</h2><p>尝试一下手写一个简单的MLP网络，包括ReLU、Softmax、Log三种激活函数，损失函数采用负对数似然函数。</p>
<p>（Softmax+Log+NLLLoss等价于CrossEntropy）</p>
<p>整体结构：$FFN1\rightarrow RELU\rightarrow FFN2\rightarrow Softmax\rightarrow Log\rightarrow NLLLoss$</p>
<p>在开始实现之前，先指出上述理论与实际实现中的<strong>差异</strong>。</p>
<ul>
<li><p>理论中，每个神经元一定由$z_i,a_i$两个部分组成，分别对应了神经元的带权输入和激活后的输出。其中带权输入是<strong>多对一</strong>，由多个结果带权求和得到，对应现在的全连接层；激活输出是<strong>一对一</strong>的，每个$a_i$由唯一的$z_i$决定，通常对应现在说的激活函数。</p>
<p><img src="https://morphling-picgo.oss-cn-shanghai.aliyuncs.com/202203211952456.png" alt="image-20220321195228358"></p>
<p>从而有了这个误差传播的公式，其中$\odot\sigma’(z^l)$对应激活函数的误差传播，$((w^{l+1})^T\delta^{(l+1)})$对应带权求和部分的误差传播：</p>
<script type="math/tex; mode=display">
\delta^l=((w^{l+1})^T\delta^{(l+1)})\odot\sigma'(z^l)</script><p>但是实际的网络中并不一定是一层全连接层、一层激活层这样搭建的，实际上也没有必要把全连接层和激活层绑定在一起，完全可以<strong>分开传播</strong>。</p>
</li>
<li><p>从实际的角度看，一些被称为“激活函数”的函数，一部分和理论中一样，是<strong>一对一</strong>的传播，比如ReLU、Log。但也有一部分虽然常被称为“激活函数”，但实际上是<strong>多对一</strong>的传播，比如Softmax，$y_i=\frac{e^{x_i}}{\sum\limits_{j=1}^n e^{x_j}}$，$y_i$由$x_1,\cdots,x_n$共同决定，这导致softmax层在反向传播的过程中其实更类似于“带权求和”的传播方式，即<strong>先求出梯度矩阵，再把误差通过这个梯度矩阵传播到上一层</strong>。</p>
</li>
<li><p>理论中向量都是以<strong>列向量</strong>的形式给出的，但实际中可能会以行向量的形式给出，这可能会导致一些困惑，并需要通过一些转置来达到同样的计算效果。</p>
</li>
<li><p>理论中只考虑了利用一个样本计算误差并反向传播、更新参数。实际情况下需要同时更新一个批量的样本，这同样需要以矩阵形式实现。</p>
</li>
<li><p>计算带权求和时，可以把偏置并入权重W计算。</p>
</li>
</ul>
<h3 id="求导"><a href="#求导" class="headerlink" title="求导"></a>求导</h3><p>这里从浅层往深层算，把每一层都作为一个向量函数</p>
<h4 id="NLLLoss"><a href="#NLLLoss" class="headerlink" title="NLLLoss"></a>NLLLoss</h4><p>函数将向量转化为标量，对应梯度是一个向量。</p>
<script type="math/tex; mode=display">
NLLLoss(X)=f_1(X)\\
f_1(X)=\sum\limits_i -x_i\cdot label_i\\
\frac{\partial f_1(X)}{\partial x_i}=-label_i\\</script><p>$label_i=I[i是真实标签]$</p>
<p>矩阵形式：</p>
<script type="math/tex; mode=display">
\frac{\partial f_1(X)}{\partial X}=-label</script><h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><p>函数将向量转化为向量，对应梯度是一个矩阵。</p>
<script type="math/tex; mode=display">
Log(X)=f_2(X)\\
f_2(X)_i=\ln x_i\\
\frac{\partial f_2(X)_i}{\partial x_j}=
\left\{
\begin{array}{}
\frac{1}{x_i},\quad i=j\\
0,\quad i\ne j
\end{array}
\right.</script><p>矩阵形式：</p>
<script type="math/tex; mode=display">
\frac{f_2(X)}{\partial X}=diag\{\frac{1}{x_1},\frac{1}{x_2},\cdots,\frac{1}{x_n}\}</script><p>实现时，如果用Hadamard乘积来表示。因为梯度是一个对角矩阵，所以左乘这个梯度矩阵相当于对倒数向量作Hadamard乘积。</p>
<h4 id="Softmax"><a href="#Softmax" class="headerlink" title="Softmax"></a>Softmax</h4><p>函数将向量转化为向量，对应梯度是一个矩阵。</p>
<script type="math/tex; mode=display">
Softmax(X)=f_3(X)\\
f_3(X)_i=\frac{e^{x_i}}{\sum\limits_k e^{x_k}}\\
\frac{\partial f_3(X)_i}{\partial x_j}=
\left\{
\begin{array}{}
\frac{e^{x_i}}{\sum\limits_k e^{x_k}}-\frac{e^{x_i}}{\sum\limits_ke^{x_k}}\cdot\frac{e^{x_j}}{\sum\limits_ke^{x_k}},\quad i=j\\
-\frac{e^{x_i}}{\sum\limits_ke^{x_k}}\cdot\frac{e^{x_j}}{\sum\limits_ke^{x_k}},\quad i\ne j
\end{array}
\right.</script><p>如果令$y_i=f_3(x_i)$，那么梯度也可以写成</p>
<script type="math/tex; mode=display">
\frac{\partial y_i}{\partial x_j}=
\left\{
\begin{array}{}
y_i-y_iy_j,\quad i=j\\
-y_iy_j,\quad i\ne j
\end{array}
\right.</script><p>矩阵形式：</p>
<script type="math/tex; mode=display">
\frac{\partial f_3(X)}{\partial X}=diag(Y)-Y\cdot Y^T</script><h4 id="FFN"><a href="#FFN" class="headerlink" title="FFN"></a>FFN</h4><p>函数将向量转化为向量，对应梯度是一个矩阵。</p>
<script type="math/tex; mode=display">
FFN(X)=f_4(X)\\
f_4(X)_i=\sum\limits_j w_{ij
}\cdot x_j\\
\frac{\partial f_4(X)_i}{x_j}=w_{ij}</script><p>形式比较简单所以直接对矩阵求导：</p>
<script type="math/tex; mode=display">
f_4(X)=WX\\
\frac{\partial f_4(X)}{\partial X}=W^T</script><h4 id="ReLU"><a href="#ReLU" class="headerlink" title="ReLU"></a>ReLU</h4><script type="math/tex; mode=display">
ReLU(X)=f_5(X)\\
f_5(X)_i=
\left\{
\begin{array}{}
0,\quad x_i \le0\\
x_i,\quad x_i >0
\end{array}
\right.\\
\frac{\partial f_5(X)_i}{\partial x_j}=
\left\{
\begin{array}{}
0,\quad i=j\\
1,\quad i\ne j
\end{array}
\right.</script><p>用矩阵形式表示比较麻烦，直接用Hadamard乘积的方式传播即可。</p>
<h3 id="python代码实现"><a href="#python代码实现" class="headerlink" title="python代码实现"></a>python代码实现</h3><p>按照通常的习惯，输入矩阵的shape是(data_size, input_size)，第一维表示批量大小，第二维表示输入向量，同样对应的输出矩阵的shape是(data_size, output_size)。所以我们给出的输入和输出向量实际上是行向量。</p>
<p>在理论中一个$n\rightarrow m$的权重矩阵维度应当是$(m, n)$的，但在实现中也对这个矩阵进行了转置，变为$(n,m)$。类似的，几乎所有矩阵需要经过转置处理。总之需要比较小心地处理这些转置，但好在除了转置之外也没有额外的问题需要解决了。</p>
<pre><code class="lang-python">import numpy as np

class Matmul:
    def __init__(self):
        self.mem = &#123;&#125;

    def forward(self, x, W):
        h = np.matmul(x, W)
        self.mem = &#123;&#39;x&#39;: x, &#39;W&#39;: W&#125;
        return h

    def backward(self, grad_y):
        &#39;&#39;&#39;
        x: shape(N, d)
        w: shape(d, d&#39;)
        grad_y: shape(N, d&#39;)
        &#39;&#39;&#39;
        x = self.mem[&#39;x&#39;]
        W = self.mem[&#39;W&#39;]

        grad_x = np.matmul(grad_y, W.T)  # shape(N, b)
        grad_W = np.matmul(x.T, grad_y)
        return grad_x, grad_W


class Relu:
    def __init__(self):
        self.mem = &#123;&#125;

    def forward(self, x):
        self.mem[&#39;x&#39;] = x
        return np.where(x &gt; 0, x, np.zeros_like(x))

    def backward(self, grad_y):
        &#39;&#39;&#39;
        grad_y: same shape as x
        &#39;&#39;&#39;
        x = self.mem[&#39;x&#39;]
        return (x &gt; 0).astype(np.float32) * grad_y


class Softmax:
    &#39;&#39;&#39;
    softmax over last dimention
    &#39;&#39;&#39;

    def __init__(self):
        self.epsilon = 1.e-8
        self.mem = &#123;&#125;

    def forward(self, x):
        &#39;&#39;&#39;
        x: shape(N, c)
        &#39;&#39;&#39;
        x_exp = np.exp(x)
        partition = np.sum(x_exp, axis=1, keepdims=True)
        out = x_exp / (partition + self.epsilon)
        #print(x_exp[:3, :3], out[:3, :3])

        self.mem[&#39;out&#39;] = out
        self.mem[&#39;x_exp&#39;] = x_exp
        return out

    def backward(self, grad_y):
        &#39;&#39;&#39;
        grad_y: same shape as x
        &#39;&#39;&#39;
        s = self.mem[&#39;out&#39;]
        sisj = np.matmul(np.expand_dims(s, axis=2), np.expand_dims(s, axis=1))  # (N, c, c)
        g_y_exp = np.expand_dims(grad_y, axis=1)
        tmp = np.matmul(g_y_exp, sisj)  # (N, 1, c)
        tmp = np.squeeze(tmp, axis=1)
        tmp = -tmp + grad_y * s
        return tmp


class Log:
    &#39;&#39;&#39;
    softmax over last dimention
    &#39;&#39;&#39;

    def __init__(self):
        self.epsilon = 1e-12
        self.mem = &#123;&#125;

    def forward(self, x):
        &#39;&#39;&#39;
        x: shape(N, c)
        &#39;&#39;&#39;
        out = np.log(x + self.epsilon)

        self.mem[&#39;x&#39;] = x
        return out

    def backward(self, grad_y):
        &#39;&#39;&#39;
        grad_y: same shape as x
        &#39;&#39;&#39;
        x = self.mem[&#39;x&#39;]

        return 1. / (x + 1e-12) * grad_y


class Model_NP:
    def __init__(self, num_inputs, num_outputs, num_hiddens = 100, lr = 1.e-5, lambda1 = 0.5):
        self.W1 = np.random.normal(size=[num_inputs + 1, num_hiddens])
        self.W2 = np.random.normal(size=[num_hiddens, num_outputs])

        self.mul_h1 = Matmul()
        self.mul_h2 = Matmul()
        self.relu = Relu()
        self.softmax = Softmax()
        self.log = Log()

        self.h2_log = None
        self.lr = lr
        self.lambda1 = lambda1
        self.num_hiddens = num_hiddens

    def forward(self, x):

        # ==========
        # todo &#39;&#39;&#39;请搭建一个MLP前馈神经网络 补全它的前向传播 MLP结构为FFN --&gt; RELU --&gt; FFN --&gt; Softmax&#39;&#39;&#39;
        # ==========

        n_sample = x.shape[0]
        out = x.reshape((n_sample, -1))
        ones = np.ones((n_sample, 1))
        out = np.concatenate((out, ones), axis=1) # (60000, 785)

        out = self.mul_h1.forward(out, self.W1) # (60000, 100)
        out = self.relu.forward(out) # (60000, 100)
        out = self.mul_h2.forward(out, self.W2) # (60000, 10)
        out = self.softmax.forward(out) # (60000, 10)
        out = self.log.forward(out) # (60000, 10)
        self.h2_log = out
        return out

    def backward(self, label):

        # ==========
        # todo &#39;&#39;&#39;补全该前馈神经网络的后向传播算法&#39;&#39;&#39;
        # ==========
        back = -label # (60000, 10)
        back = self.log.backward(back) # (60000, 10)
        back = self.softmax.backward(back) # (60000, 10)
        back, self.grad_w2 = self.mul_h2.backward(back)
        back = self.relu.backward(back)
        back, self.grad_w1 = self.mul_h1.backward(back)

    def update(self):

        # ==========
        # todo &#39;&#39;&#39;更新该前馈神经网络的参数&#39;&#39;&#39;
        # ==========
        self.W1 += -self.grad_w1 * self.lr
        self.W2 += -self.grad_w2 * self.lr

if __name__ == &#39;__main__&#39;:
    model = Model_NP()
</code></pre>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script> 
<script>
    var gitalk = new Gitalk({
            clientID: 'b8ab854d61e4537d8b06',
            clientSecret: '2557531f91b562289cfc3025675934139fc97766',
            repo: 'gitalk-repo',
            owner: 'liyunfan1223',
            admin: ['liyunfan1223'],
            id: md5(location.pathname),
            // facebook-like distraction free mode
            distractionFreeMode: false
        })
   gitalk.render('gitalk-container')
</script>
</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2022/03/19/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/miniob%E8%AE%B0%E5%BD%95/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/favicon_io/android-chrome-512x512.png" alt="MorphLing's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        liyunfan1223@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2022/03/">三月 2022<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/02/">二月 2022<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/01/">一月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/12/">十二月 2021<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/11/">十一月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/10/">十月 2021<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/09/">九月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/08/">八月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/07/">七月 2021<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/06/">六月 2021<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/05/">五月 2021<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/04/">四月 2021<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/03/">三月 2021<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/02/">二月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/01/">一月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/12/">十二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/10/">十月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/08/">八月 2020<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/05/">五月 2020<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/04/">四月 2020<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">博客搭建<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/">工具配置<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/">算法竞赛<span class="sidebar_archives-count">55</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">课程笔记<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E9%9A%8F%E4%BE%BF%E8%81%8A%E8%81%8A/">随便聊聊<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/">项目总结<span class="sidebar_archives-count">30</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/links" title="友链">
                
                    <i class="material-icons sidebar-material-icons">face</i>
                
                友链
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">cloud_circle</i>
                
                标签云
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

    <a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.help
        <span class="mdl-button__ripple-container">
          <span class="mdl-ripple"></span>
        </span>
      </div>
    </a>

-->

<!-- Feedback -->
<!--

    <a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.feedback
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2020&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Moonglade
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- GitTalk -->





<!-- UC Browser Compatible -->

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->

<script type="text/ls-javascript" id="Bing-Background-script">
    queue.offer(function(){
        $('body').attr('data-original', 'https://api.i-meto.com/bing?type=T');
    });
</script>


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
    
</html>
