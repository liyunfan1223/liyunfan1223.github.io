<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>












    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            点分治(树分治)专题 | 
        
        Moonglade
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon_io_c/favicon-32x32.png">
    <link rel="icon" href="/img/favicon_io_c/android-chrome-512x512.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="简介如果处理“所有经过某一个顶点的链对答案的贡献”的时间复杂度为$O(n)$或者$O(nlogn)$，那么运用点分治的思想可以把问题规模降为$O(nlogn)$或$O(nlog^2n)$，而非暴力枚举顶点计算答案的$O(n^2)$。">
    <meta name="keywords" content=",XCPC,树,点分治">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/tranquil-heart.min.css?ul3p9I9MsbOxK0L+BHzDDg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        background-color: ;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Moonglade">
    <meta name="msapplication-starturl" content="https://moonglade.top/2020/10/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/%E7%82%B9%E5%88%86%E6%B2%BB(%E6%A0%91%E5%88%86%E6%B2%BB)%E4%B8%93%E9%A2%98/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Moonglade">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon_io_c/apple-touch-icon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://moonglade.top/2020/10/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/%E7%82%B9%E5%88%86%E6%B2%BB(%E6%A0%91%E5%88%86%E6%B2%BB)%E4%B8%93%E9%A2%98/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="点分治(树分治)专题 | Moonglade">
    <meta property="og:image" content="/img/favicon_io_c/android-chrome-512x512.png">
    <meta property="og:description" content="简介如果处理“所有经过某一个顶点的链对答案的贡献”的时间复杂度为$O(n)$或者$O(nlogn)$，那么运用点分治的思想可以把问题规模降为$O(nlogn)$或$O(nlog^2n)$，而非暴力枚举顶点计算答案的$O(n^2)$。">
    <meta property="og:article:tag" content="XCPC"> <meta property="og:article:tag" content="树"> <meta property="og:article:tag" content="点分治"> 

    
        <meta property="article:published_time" content="Thu Oct 08 2020 00:23:44 GMT+0800">
        <meta property="article:modified_time" content="Sat Feb 26 2022 18:13:37 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://moonglade.top/2020/10/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/%E7%82%B9%E5%88%86%E6%B2%BB(%E6%A0%91%E5%88%86%E6%B2%BB)%E4%B8%93%E9%A2%98/index.html" />
    

    <!-- Structured-data for SEO -->
    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 6.0.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="post-toc-number">1.</span> <span class="post-toc-text">简介</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%86%E6%B2%BB"><span class="post-toc-number">2.</span> <span class="post-toc-text">分治</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%AE%A1%E7%AE%97%E8%B4%A1%E7%8C%AE"><span class="post-toc-number">3.</span> <span class="post-toc-text">计算贡献</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="post-toc-number">4.</span> <span class="post-toc-text">例题</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                点分治(树分治)专题
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/favicon_io/android-chrome-512x512.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>MorphLing</strong>
        <span>10月 08, 2020</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-none-link" href="/tags/XCPC/" rel="tag">XCPC</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/%E6%A0%91/" rel="tag">树</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/%E7%82%B9%E5%88%86%E6%B2%BB/" rel="tag">点分治</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=点分治(树分治)专题&url=https://moonglade.top/2020/10/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/%E7%82%B9%E5%88%86%E6%B2%BB(%E6%A0%91%E5%88%86%E6%B2%BB)%E4%B8%93%E9%A2%98/index.html&pic=https://moonglade.top/img/favicon_io_c/favicon-32x32.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=点分治(树分治)专题&url=https://moonglade.top/2020/10/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/%E7%82%B9%E5%88%86%E6%B2%BB(%E6%A0%91%E5%88%86%E6%B2%BB)%E4%B8%93%E9%A2%98/index.html&via=MorphLing" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://moonglade.top/2020/10/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/%E7%82%B9%E5%88%86%E6%B2%BB(%E6%A0%91%E5%88%86%E6%B2%BB)%E4%B8%93%E9%A2%98/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://moonglade.top/2020/10/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/%E7%82%B9%E5%88%86%E6%B2%BB(%E6%A0%91%E5%88%86%E6%B2%BB)%E4%B8%93%E9%A2%98/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>如果处理“所有经过某一个顶点的链对答案的贡献”的时间复杂度为$O(n)$或者$O(nlogn)$，那么运用点分治的思想可以把问题规模降为$O(nlogn)$或$O(nlog^2n)$，而非暴力枚举顶点计算答案的$O(n^2)$。</p>
<span id="more"></span>
<p>所以说，点分治是一种在树上统计合法链个数的思想。显而易见的，对于当前顶点$x$，任意一条链要么经过$x$，要么不经过$x$。于是我们只需要计算那些经过$x$的链，剩下不经过$x$的链则统统放在子树中递归计算，此为分治。</p>
<p>那么，怎么分治？按照常规的递推思路来考虑，处理完当前顶点后，递归进入所有与顶点相邻的顶点并分别处理它们？不行，因为很容易可以找到一条退化成链的树（见下图），每一层递归只能使问题规模减少1（去掉一个顶点），却要递归到第n层，显然，时间复杂度是$O(n^2)$的。<br><img src="https://img-blog.csdnimg.cn/20201008002300701.png#pic_center" alt="在这里插入图片描述"></p>
<p>比起点分治，这似乎更像树形dp，但树形dp的前提是每一个点的状态都可以借助其子结点$O(1)$处理（在例题中可以看到一个既能用点分治，又能用树形dp来解决的例子）。但如果每一条链的状态都不能够合并，无法用dp来降低复杂度呢？实际上，点分治可以说就是为了解决一些无法保存状态的树形dp而发明的一种“优雅的暴力”。</p>
<p>点分治维护其复杂度的关键在于“找重心”。依然从最难处理的链来考虑问题，如果每次递归进入一颗子树时，先找子树的重心，再以重心来分割子树，可以发现每一次分割都使问题的规模减少为原来的一半，那么经过$O(logn)$次分割，问题规模一定被减少到1，也就是每个顶点都已被考虑到。如果用递归树来刻画这一过程（见下图），可以发现树高为$log(n)$，每一层的时间之和都为$T(n)$，于是，我们成功将$O(n^2)$的复杂度，通过找重心降低到$O(nlogn)$。<br><img src="https://img-blog.csdnimg.cn/20201008002307585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="分治"><a href="#分治" class="headerlink" title="分治"></a>分治</h2><p>点分治的题目中，“分治”部分几乎是一成不变的，无非是找到重心后，以重心为根重新计算子树大小，并利用计算结果进一步去找子树的重心。简而言之就是两个函数Getroot和Getsz而已。</p>
<pre><code class="lang-cpp">int Getroot(int x, int f) &#123;
    int sum = 0, mx = 0, tmp;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        tmp = Getroot(to, x);
        sum += tmp;
        mx = max(mx, tmp);
    &#125;
    sum++;
    mx = max(mx, tot - sum);
    if (mx &lt; MN) &#123;
        MN = mx;
        rt = x;
    &#125;
    return sum;
&#125;

void Getsz(int x, int f) &#123;
    sz[x] = 0;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        Getsz(to, x);
        sz[x] += sz[to];
    &#125;
    sz[x]++;
&#125;
</code></pre>
<h2 id="计算贡献"><a href="#计算贡献" class="headerlink" title="计算贡献"></a>计算贡献</h2><p>但这只是第一步。点分治中最重要，最灵活，也最需要投入思考的点，其实是一开始提到的如何计算“所有经过某一个顶点的链对答案的贡献”。</p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3806">P3806 【模板】点分治1</a>    </p>
<p>以这道最基本的模板题来说。相对而言比较经典的计算过程是这样的。</p>
<p>1、一次性收集所有链信息，存放在一个vector或数组中。</p>
<pre><code class="lang-cpp">void Getdis(int x, int len, int f) &#123;
    D.push_back(len);
    for (auto T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to] || to == f) continue;
        Getdis(to, len + v, x);
    &#125;
&#125;
</code></pre>
<p>2、利用数据结构（这里用的是桶）计算链对答案的贡献</p>
<pre><code class="lang-cpp">void calc(int x, int len, int type) &#123;
    D.clear();
    Getdis(x, len, -1);
    for (int y : D) &#123;
        if (y &gt; M) continue;
        for (int i = 1; i &lt;= m; i++) &#123;
            if (q[i] - y &lt; 0) continue;
            cnt[i] += type * bucket[q[i] - y];
        &#125;
        bucket[y]++;
    &#125;
    for (int y : D) &#123;
        if (y &gt; M) continue;
        bucket[y]--;
    &#125;
&#125;
</code></pre>
<p>3、先计算子树内所有链的贡献（cal(x, 0, 1)），再利用容斥原理，去除不合法的链（calc(to, v, -1)）</p>
<pre><code class="lang-cpp">void solve(int x) &#123;
    vis[x] = 1;
    calc(x, 0, 1);
    for (auto T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to]) continue;
        calc(to, v, -1);
        tot = sz[to], MN = INF;
        Getroot(to, -1);
        Getsz(rt, -1);
        solve(rt);
    &#125;
&#125;
</code></pre>
<p>关于第三点或许需要再举个例子说明一下。<br><img src="https://img-blog.csdnimg.cn/20201008002316756.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>若当前以A为根收集链信息，一共可以得到五条链：</p>
<p>A</p>
<p>A-&gt;B</p>
<p>A-&gt;B-&gt;D</p>
<p>A-&gt;B-&gt;E</p>
<p>A-&gt;C</p>
<p>而用于计算答案的链，实际上是从收集到的链中任选两条，组合成一条新链再进行计算的。比如选择A-&gt;B和A-&gt;C，实际上是B-&gt;A-&gt;C这条链，选择A和A-&gt;B实际上就是A-&gt;B这条链，这两条都是合法的。但如果选择的是A-&gt;B-&gt;D和A-&gt;B-&gt;E时，选择的其实是D-&gt;B-&gt;A-&gt;B-&gt;E，但D到E的简单路径是D-&gt;B-&gt;E，也就是这条链不存在，这是不合法的。实际上，同时经过A和B的两条链组合之后总是不合法的，而cal(to, v, -1)的意义就在于选出这样的不合法的链，并把它们对答案的贡献消除。</p>
<p>完整的代码贴在这里</p>
<pre><code class="lang-cpp">#include &lt;bits/stdc++.h&gt;
#define debug(x) cerr &lt;&lt; #x &lt;&lt; &quot; : &quot; &lt;&lt; x &lt;&lt; endl
using namespace std;
typedef long long LL;

const int N = 1e4 + 5, M = 1e7 + 5, P = 1e2 + 5, INF = 0x3f3f3f3f;

struct Edge &#123;
    int to, v;
&#125;;

int n, m, k, q[P], cnt[P], bucket[M];

vector&lt;int&gt; D;

/**variables of tree divide*/
int tot, sz[N], MN, rt;

bool vis[N];

vector&lt;Edge&gt; G[N];

int Getroot(int x, int f) &#123;
    int sum = 0, mx = 0, tmp;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        tmp = Getroot(to, x);
        sum += tmp;
        mx = max(mx, tmp);
    &#125;
    sum++;
    mx = max(mx, tot - sum);
    if (mx &lt; MN) &#123;
        MN = mx;
        rt = x;
    &#125;
    return sum;
&#125;

void Getsz(int x, int f) &#123;
    sz[x] = 0;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        Getsz(to, x);
        sz[x] += sz[to];
    &#125;
    sz[x]++;
&#125;

void Getdis(int x, int len, int f) &#123;
    D.push_back(len);
    for (auto T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to] || to == f) continue;
        Getdis(to, len + v, x);
    &#125;
&#125;

void calc(int x, int len, int type) &#123;
    D.clear();
    Getdis(x, len, -1);
    for (int y : D) &#123;
        if (y &gt; M) continue;
        for (int i = 1; i &lt;= m; i++) &#123;
            if (q[i] - y &lt; 0) continue;
            cnt[i] += type * bucket[q[i] - y];
        &#125;
        bucket[y]++;
    &#125;
    for (int y : D) &#123;
        if (y &gt; M) continue;
        bucket[y]--;
    &#125;
&#125;

void solve(int x) &#123;
    vis[x] = 1;
    calc(x, 0, 1);
    for (auto T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to]) continue;
        calc(to, v, -1);
        tot = sz[to], MN = INF;
        Getroot(to, -1);
        Getsz(rt, -1);
        solve(rt);
    &#125;
&#125;

int main() &#123;
    cin &gt;&gt; n &gt;&gt; m;
    for (int i = 1, u, v, w; i &lt;= n - 1; i++) &#123;
        scanf(&quot;%d %d %d&quot;, &amp;u, &amp;v, &amp;w);
        G[u].push_back(&#123;v, w&#125;);
        G[v].push_back(&#123;u, w&#125;);
    &#125;
    for (int i = 1; i &lt;= m; i++) scanf(&quot;%d&quot;, &amp;q[i]);
    tot = n, MN = INF;
    Getroot(1, -1);
    Getsz(rt, -1);
    solve(rt);
    for (int i = 1; i &lt;= m; i++) &#123;
        printf(&quot;%s\n&quot;, cnt[i] ? &quot;AYE&quot; : &quot;NAY&quot;);
    &#125;
    return 0;
&#125;
</code></pre>
<p>至此，一个完整的点分治就结束了。</p>
<p>但这并不是唯一的计算贡献的方法。同样以这道题目来说，我们其实不需要一次性收集所有的链，而是可以先收集某个子树中的链，根据桶的信息修改答案，把收集到的链存入桶中，再去下一个子树收集链信息。如此一来就可以避免计算不合法的链，也就不需要利用容斥来消除它们。</p>
<pre><code class="lang-cpp">void calc(int x) &#123;
    judge[0] = 1;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to]) continue;
        D.clear();
        Getdis(to, T.v, x);
        for (int i : D) &#123;
            for (int j = 1; j &lt;= m; j++)
                if (query[j] &gt;= i) ans[j] |= judge[query[j] - i];
        &#125;
        for (int i : D) &#123;
            if (i &lt; 10000010 &amp;&amp; !judge[i]) &#123;
                C.push_back(i);
                judge[i] = 1;
            &#125;
        &#125;
    &#125;
    for (int i : C) judge[i] = 0;
    C.clear();
&#125;
</code></pre>
<p>我个人认为点分治只能说是一种思想，而不能称为一种算法，就在于每道题计算贡献的方法都不一样。因此，考虑是否要运用点分治解决问题，最关键的就是能否找到一个计算贡献的方法。许多计算方法都要套一个树状数组或者线段树之类的结构，这也都会对最终的时间复杂度产生影响。</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2634">P2634 [国家集训队]聪聪可可</a></p>
<p>最简单的点分治，$O(n)$收集信息，$O(1)$修改答案即可。</p>
<pre><code class="lang-cpp">#include &lt;bits/stdc++.h&gt;
#define debug(x) cerr &lt;&lt; #x &lt;&lt; &quot; : &quot; &lt;&lt; x &lt;&lt; endl
using namespace std;
typedef long long LL;

const int N = 2e5 + 5, INF = 0x3f3f3f3f;

struct Edge &#123;
    int to, v;
&#125;;

vector&lt;Edge&gt; G[N];

bool vis[N];

int n, tot, sz[N], MN, rt, a[N];

LL ans[3], cnt[3];

int add(int x, int y) &#123;return x + y &gt;= 3 ? x + y - 3 : x + y;&#125;

int Getroot(int x, int f) &#123;
    int sum = 0, mx = 0, tmp;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        tmp = Getroot(to, x);
        sum += tmp;
        mx = max(mx, tmp);
    &#125;
    sum++;
    mx = max(mx, tot - sum);
    if (mx &lt; MN) &#123;
        MN = mx;
        rt = x;
    &#125;
    return sum;
&#125;

void Getsz(int x, int f) &#123;
    sz[x] = 0;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        Getsz(to, x);
        sz[x] += sz[to];
    &#125;
    sz[x]++;
&#125;

void Getdis(int x, int len, int f) &#123;
    cnt[len]++;
    for (auto T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to] || to == f) continue;
        Getdis(to, add(len, v), x);
    &#125;
&#125;

void calc(int x, int len, int type) &#123;
    memset(cnt, 0, sizeof(cnt));
    Getdis(x, len, -1);
    for (int i = 0; i &lt;= 2; i++) &#123;
        for (int j = 0; j &lt;=2; j++) &#123;
            ans[add(i, j)] += cnt[i] * cnt[j] * type;
        &#125;
    &#125;
&#125;

void solve(int x) &#123;
    vis[x] = 1;
    calc(x, 0, 1);
    for (auto T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to]) continue;
        calc(to, v, -1);
        tot = sz[to], MN = INF;
        Getroot(to, -1);
        Getsz(rt, -1);
        solve(rt);
    &#125;
&#125;

int main() &#123;
    cin &gt;&gt; n;
    for (int i = 1, u, v, w; i &lt;= n - 1; i++) &#123;
        scanf(&quot;%d %d %d&quot;, &amp;u, &amp;v, &amp;w);
        w %= 3;
        G[u].push_back(&#123;v, w&#125;);
        G[v].push_back(&#123;u, w&#125;);
    &#125;
    tot = n, MN = INF;
    Getroot(1, -1);
    Getsz(rt, -1);
    solve(rt);
    LL gcd = __gcd(ans[0], ans[0] + ans[1] + ans[2]);
    printf(&quot;%lld/%lld&quot;, ans[0] / gcd, (ans[0] + ans[1] + ans[2]) / gcd);
    return 0;
&#125;
</code></pre>
<p>可能因为要处理的信息太简单了，用树形dp一样可以过这道题，复杂度还更低。</p>
<pre><code class="lang-cpp">#include &lt;bits/stdc++.h&gt;

using namespace std;
typedef long long LL;

const int N = 2e4 + 5;

int n;

LL dp[N][3], sum[N][3], ans[3];

struct Edge &#123;
    int to, v;
&#125;;
vector&lt;Edge&gt; G[N];

int add(int x, int y) &#123;return x + y &gt;= 3 ? x + y - 3 : x + y;&#125;

int sub(int x, int y) &#123;return x - y &lt; 0 ? x - y + 3 : x - y;&#125;

void dfs(int x, int f) &#123;
    dp[x][0]++;
    for (auto T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (to == f) continue;
        dfs(to, x);
        for (int i = 0; i &lt;= 2; i++) &#123;
            for (int j = 0; j &lt;= 2; j++) &#123;
                ans[add(i, j)] += dp[to][sub(i, v)] * dp[x][j];
            &#125;
        &#125;
        for (int i = 0; i &lt;= 2; i++) &#123;
            dp[x][i] += dp[to][sub(i, v)];
        &#125;
    &#125;
&#125;

int main() &#123;
    cin &gt;&gt; n;
    for (int i = 1, u, v, w; i &lt;= n - 1; i++) &#123;
        scanf(&quot;%d %d %d&quot;, &amp;u, &amp;v, &amp;w);
        w %= 3;
        G[u].push_back(&#123;v,w&#125;);
        G[v].push_back(&#123;u,w&#125;);
    &#125;
    dfs(1, -1);
    ans[0] *= 2;
    ans[1] *= 2;
    ans[2] *= 2;
    ans[0] += n;
    LL gcd = __gcd(ans[0], ans[0] + ans[1] + ans[2]);
    printf(&quot;%lld/%lld&quot;, ans[0] / gcd, (ans[0] + ans[1] + ans[2]) / gcd);
    return 0;
&#125;
</code></pre>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4178">P4178 Tree</a></p>
<p>利用树状数组统计答案，非常经典。</p>
<pre><code class="lang-cpp">#include &lt;bits/stdc++.h&gt;

using namespace std;

const int N = 4e4 + 5, M = 2e4 + 5, INF = 0x3f3f3f3f;

struct Edge &#123;
    int to, v;
&#125;;

struct BIT &#123;
    int t[N];
    int lowbit(int x) &#123;return x &amp;(-x);&#125;
    void add(int x, int v) &#123;
        x += 1;
        while(x &lt; N) &#123;
            t[x] += v;
            x += lowbit(x);
        &#125;
    &#125;
    int ask(int x) &#123;
        x += 1;
        int res = 0;
        while(x) &#123;
            res += t[x];
            x -= lowbit(x);
        &#125;
        return res;
    &#125;
&#125;bit;

vector&lt;Edge&gt; G[N];

vector&lt;int&gt; D;

bool vis[N];

int n, k, tot, sz[N], MN, rt, ans;

int Getroot(int x, int f) &#123;
    int sum = 0, mx = 0, tmp;
    for (auto T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        tmp = Getroot(to, x);
        sum += tmp;
        mx = max(mx, tmp);
    &#125;
    sum++;
    mx = max(mx, tot - sum);
    if (mx &lt; MN) &#123;
        MN = mx;
        rt = x;
    &#125;
    return sum;
&#125;

void Getsz(int x, int f) &#123;
    sz[x] = 0;
    for (Edge T : G[x]) &#123;
        int to = T.to;
        if (vis[to] || to == f) continue;
        Getsz(to, x);
        sz[x] += sz[to];
    &#125;
    sz[x]++;
&#125;

void Getdis(int x,int len, int f) &#123;
    D.push_back(len);
    for (Edge T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to] || to == f) continue;
        Getdis(to, len + v, x);
    &#125;
&#125;

int calc(int x, int len) &#123;
    int res = 0;
    Getdis(x, len, -1);
    D.push_back(0);
    for (int y : D) &#123;
        if (y &gt; k) continue;
        res += bit.ask(k - y);
        bit.add(y, 1);
    &#125;
    for (int y : D) &#123;
        if (y &gt; k) continue;
        bit.add(y, -1);
    &#125;
    D.clear();
    return res;
&#125;

void solve(int x) &#123;
    vis[x] = 1;
    ans += calc(x, 0);
    for (Edge T : G[x]) &#123;
        int to = T.to, v = T.v;
        if (vis[to]) continue;
        ans -= calc(to, v);
        tot = sz[to], MN = INF;
        Getroot(to, -1);
        Getsz(rt, -1);
        solve(rt);
    &#125;
&#125;

int main() &#123;
    cin &gt;&gt; n;
    for (int i = 1, u, v, w; i &lt;= n - 1; i++) &#123;
        scanf(&quot;%d %d %d&quot;, &amp;u, &amp;v, &amp;w);
        G[u].push_back(&#123;v, w&#125;);
        G[v].push_back(&#123;u, w&#125;);
    &#125;
    cin &gt;&gt; k;
    tot = n, MN = INF;
    Getroot(1, -1);
    Getsz(rt, -1);
    solve(rt);
    printf(&quot;%d\n&quot;, ans - n);
    return 0;
&#125;
</code></pre>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/gym/102452/problem/C">Constructing Ranches</a></p>
<p>需要利用排序、离散化、树状数组来计算贡献，可能还要卡卡常，比较清奇。</p>
<pre><code class="lang-cpp">#include &lt;bits/stdc++.h&gt;

using namespace std;
typedef long long LL;

const int N = 2e5 + 5, INF = 0x3f3f3f3f;

struct BIT &#123;
    int t[N];
    int lowbit(int x) &#123;return x &amp;(-x);&#125;
    void add(int x, int v) &#123;
        x++;
        while(x &lt; N) &#123;
            t[x] += v;
            x += lowbit(x);
        &#125;
    &#125;
    int ask(int x) &#123;
        x++;
        int res = 0;
        while(x) &#123;
            res += t[x];
            x -= lowbit(x);
        &#125;
        return res;
    &#125;
&#125;bit;

struct Edge&#123;
    LL len;
    int mx;
&#125;;
vector&lt;int&gt; G[N], dc, add;

vector&lt;Edge&gt; D;

unordered_map&lt;LL, int&gt; pos;

bool vis[N];

int T, n, tot, sz[N], MN, rt, a[N];

LL ans;

int Getroot(int x, int f) &#123;
    int sum = 0, mx = 0, tmp;
    for (int to : G[x]) &#123;
        if (vis[to] || to == f) continue;
        tmp = Getroot(to, x);
        sum += tmp;
        mx = max(mx, tmp);
    &#125;
    sum++;
    mx = max(mx, tot - sum);
    if (mx &lt; MN) &#123;
        MN = mx;
        rt = x;
    &#125;
    return sum;
&#125;

void Getsz(int x, int f) &#123;
    sz[x] = 0;
    for (int to : G[x]) &#123;
        if (vis[to] || to == f) continue;
        Getsz(to, x);
        sz[x] += sz[to];
    &#125;
    sz[x]++;
&#125;

void Getdis(int x,LL len, int mx, int f) &#123;
    D.push_back(&#123;len, mx&#125;);
    for (int to : G[x]) &#123;
        if (vis[to] || to == f) continue;
        Getdis(to, len + a[to], max(mx, a[to]), x);
    &#125;
&#125;

LL calc(int x, LL len, int mx, int top) &#123;
    dc.clear(); pos.clear(); D.clear(); add.clear();
    if (top == 0) top = a[x];
    LL res = 0;
    Getdis(x, len, mx, -1);
    sort(D.begin(), D.end(), [&amp;](Edge u, Edge v) &#123;
        return u.mx &gt; v.mx;
    &#125;);
    for (auto y : D) &#123;
        dc.push_back(y.len - top);
    &#125;
    sort(dc.begin(), dc.end());
    dc.erase(unique(dc.begin(), dc.end()), dc.end());
    for (auto y : D) &#123;
        int idx = lower_bound(dc.begin(), dc.end(), y.len - top) - dc.begin();
        res += bit.ask(idx);
        idx = lower_bound(dc.begin(), dc.end(), y.mx * 2 - y.len + 1) - dc.begin();
        if (idx &gt;= 0) &#123;
            bit.add(idx, 1);
            add.push_back(idx);
        &#125;
    &#125;
    for (auto y : add) bit.add(y, -1);
    return res;
&#125;

void solve(int x) &#123;
    vis[x] = 1;
    ans += calc(x, a[x], a[x], 0);
    for (int to : G[x]) &#123;
        if (vis[to]) continue;
        ans -= calc(to, a[x] + a[to], max(a[x], a[to]), a[x]);
        tot = sz[to], MN = INF;
        Getroot(to, -1);
        Getsz(rt, -1);
        solve(rt);
    &#125;
&#125;

int main() &#123;
    cin &gt;&gt; T;
    while(T--) &#123;
        cin &gt;&gt; n;
        for (int i = 1; i &lt;= n; i++) &#123;
            vis[i] = 0;
            scanf(&quot;%d&quot;, &amp;a[i]);
            G[i].clear();
        &#125;
        ans = 0;
        for (int i = 1, u, v, w; i &lt;= n - 1; i++) &#123;
            scanf(&quot;%d %d&quot;, &amp;u, &amp;v);
            G[u].push_back(v);
            G[v].push_back(u);
        &#125;
        tot = n, MN = INF;
        Getroot(1, -1);
        Getsz(rt, -1);
        solve(rt);
        printf(&quot;%lld\n&quot;, ans);
    &#125;
    return 0;
&#125;
</code></pre>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script> 
<script>
    var gitalk = new Gitalk({
            clientID: 'b8ab854d61e4537d8b06',
            clientSecret: '2557531f91b562289cfc3025675934139fc97766',
            repo: 'gitalk-repo',
            owner: 'liyunfan1223',
            admin: ['liyunfan1223'],
            id: md5(location.pathname),
            // facebook-like distraction free mode
            distractionFreeMode: false
        })
   gitalk.render('gitalk-container')
</script>
</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2020/11/03/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/csapp-datalab/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2020/08/25/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/2020%E6%9D%AD%E7%94%B5%E6%9A%91%E6%9C%9F%E5%A4%9A%E6%A0%A1%E7%AC%AC%E5%85%AB%E5%9C%BA/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/favicon_io/android-chrome-512x512.png" alt="MorphLing's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        liyunfan1223@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2022/07/">七月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/06/">六月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/05/">五月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/04/">四月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/03/">三月 2022<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/02/">二月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/01/">一月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/12/">十二月 2021<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/11/">十一月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/10/">十月 2021<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/09/">九月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/08/">八月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/07/">七月 2021<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/06/">六月 2021<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/05/">五月 2021<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/04/">四月 2021<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/03/">三月 2021<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/02/">二月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/01/">一月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/12/">十二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/10/">十月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/08/">八月 2020<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/05/">五月 2020<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/04/">四月 2020<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">博客搭建<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/">算法竞赛<span class="sidebar_archives-count">55</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">课程笔记<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E9%9A%8F%E4%BE%BF%E8%81%8A%E8%81%8A/">随便聊聊<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/">项目总结<span class="sidebar_archives-count">27</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/links" title="友链">
                
                    <i class="material-icons sidebar-material-icons">face</i>
                
                友链
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">cloud_circle</i>
                
                标签云
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

    <a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.help
        <span class="mdl-button__ripple-container">
          <span class="mdl-ripple"></span>
        </span>
      </div>
    </a>

-->

<!-- Feedback -->
<!--

    <a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.feedback
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2020&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Moonglade
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- GitTalk -->





<!-- UC Browser Compatible -->

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->

<script type="text/ls-javascript" id="Bing-Background-script">
    queue.offer(function(){
        $('body').attr('data-original', 'https://api.i-meto.com/bing?type=T');
    });
</script>


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
    
</html>
