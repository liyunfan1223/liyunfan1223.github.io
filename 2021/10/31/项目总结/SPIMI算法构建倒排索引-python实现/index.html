<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>












    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            SPIMI算法构建倒排索引 python实现 | 
        
        Moonglade
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon_io_c/favicon-32x32.png">
    <link rel="icon" href="/img/favicon_io_c/android-chrome-512x512.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/tranquil-heart.min.css?ul3p9I9MsbOxK0L+BHzDDg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        background-color: ;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Moonglade">
    <meta name="msapplication-starturl" content="https://moonglade.top/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/SPIMI%E7%AE%97%E6%B3%95%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95-python%E5%AE%9E%E7%8E%B0/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Moonglade">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon_io_c/apple-touch-icon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://moonglade.top/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/SPIMI%E7%AE%97%E6%B3%95%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95-python%E5%AE%9E%E7%8E%B0/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="SPIMI算法构建倒排索引 python实现 | Moonglade">
    <meta property="og:image" content="/img/favicon_io_c/android-chrome-512x512.png">
    <meta property="og:description" content="">
    

    
        <meta property="article:published_time" content="Sun Oct 31 2021 19:13:43 GMT+0800">
        <meta property="article:modified_time" content="Sat Mar 19 2022 17:42:06 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://moonglade.top/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/SPIMI%E7%AE%97%E6%B3%95%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95-python%E5%AE%9E%E7%8E%B0/index.html" />
    

    <!-- Structured-data for SEO -->
    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 6.0.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95%E6%96%87%E4%BB%B6dict-index-txt"><span class="post-toc-number">1.</span> <span class="post-toc-text">构建倒排索引文件dict.index.txt</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%A2%84%E5%87%86%E5%A4%87"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">预准备</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%88%86%E5%9D%97%E5%A4%A7%E5%B0%8F%EF%BC%8C%E9%85%8D%E7%BD%AE%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%8A%E9%99%90"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">设置分块大小，配置线程池上限</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%A4%84%E7%90%86%E5%88%86%E5%9D%97"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">多线程处理分块</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%90%88%E5%B9%B6%E5%A4%9A%E4%B8%AA%E7%B4%A2%E5%BC%95%E5%9D%97"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">合并多个索引块</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B8%83%E5%B0%94%E6%9F%A5%E8%AF%A2"><span class="post-toc-number">2.</span> <span class="post-toc-text">布尔查询</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%80%BB%E7%BB%93"><span class="post-toc-number">3.</span> <span class="post-toc-text">总结</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="post-toc-number">4.</span> <span class="post-toc-text">代码</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                SPIMI算法构建倒排索引 python实现
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/favicon_io/android-chrome-512x512.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>MorphLing</strong>
        <span>10月 31, 2021</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=SPIMI算法构建倒排索引 python实现&url=https://moonglade.top/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/SPIMI%E7%AE%97%E6%B3%95%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95-python%E5%AE%9E%E7%8E%B0/index.html&pic=https://moonglade.top/img/favicon_io_c/favicon-32x32.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=SPIMI算法构建倒排索引 python实现&url=https://moonglade.top/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/SPIMI%E7%AE%97%E6%B3%95%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95-python%E5%AE%9E%E7%8E%B0/index.html&via=MorphLing" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://moonglade.top/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/SPIMI%E7%AE%97%E6%B3%95%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95-python%E5%AE%9E%E7%8E%B0/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://moonglade.top/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/SPIMI%E7%AE%97%E6%B3%95%E6%9E%84%E5%BB%BA%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95-python%E5%AE%9E%E7%8E%B0/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="构建倒排索引文件dict-index-txt"><a href="#构建倒排索引文件dict-index-txt" class="headerlink" title="构建倒排索引文件dict.index.txt"></a>构建倒排索引文件dict.index.txt</h2><h3 id="预准备"><a href="#预准备" class="headerlink" title="预准备"></a>预准备</h3><h4 id="设置分块大小，配置线程池上限"><a href="#设置分块大小，配置线程池上限" class="headerlink" title="设置分块大小，配置线程池上限"></a>设置分块大小，配置线程池上限</h4><pre><code class="lang-python"># 配置线程池参数
max_worker = 8 # 线程池上线
filenum = 100000 # 文件总数
blocksize = 5000 # 每个block的文件数量
pool = ThreadPoolExecutor(max_workers = max_worker)
threads = []

blocknum = (filenum - 1) // blocksize + 1 # 计算总共需要几个block
begin_time = time()
print(&quot;max_worker:%d\tFilenum:%d\tBlocksize:%d\tBlocknum:%d&quot; %(max_worker, filenum, blocksize, blocknum))
print(&quot;开始构建局部索引...&quot;)
# 将文档分入不同的block
for i in range(filenum // blocksize):
    thread = pool.submit(job, i * blocksize + 1, i * blocksize + blocksize, i + 1)
    threads.append(thread)

    # 将剩余的文档归入最后一个block
    if filenum % blocksize != 0:
        thread = pool.submit(job, filenum - (filenum % blocksize) + 1, filenum, filenum // blocksize + 1)
        threads.append(thread)
</code></pre>
<h3 id="多线程处理分块"><a href="#多线程处理分块" class="headerlink" title="多线程处理分块"></a>多线程处理分块</h3><ol>
<li>文本预处理（空格和制表符分词、大小写转换、去除Top100停用词）</li>
<li>在内存中生成倒排记录表并进行压缩(Delta编码记录增量)</li>
<li>对条目按照词项的字典序排序</li>
</ol>
<pre><code class="lang-python"># 预处理读入数据
def job(docl, docr, blockid):
    wordsDict = &#123;&#125;
    lastDocId = &#123;&#125;
    stopWords = []
    for docid in range(docl, docr + 1):
        f = open(&quot;data/&quot; + str(docid) + &quot;.txt&quot;, &#39;r&#39;, encoding = &#39;utf-8&#39;)
        lines = f.readlines()
        f.close()
        tempDict = &#123;&#125;
        for line in lines:
            # 按照空格和制表符分割
            words = re.split(&#39;[ \t]&#39;, line.strip())
            for word in words:
                # 去除停用词
                if (word in stopWords): continue
                # 将大写转化为小写
                word = word.lower()
                if (word in tempDict):
                    continue
                tempDict[word] = 1
                if not (word in wordsDict):
                    wordsDict[word] = [str(docid), 1]
                    lastDocId[word] = docid
                else:
                    # 倒排记录表压缩(Delta编码,记录增量)
                    wordsDict[word][0] += &#39;,&#39; + str(docid - lastDocId[word])
                    lastDocId[word] = docid
                    wordsDict[word][1] += 1
                    # df[word] += 1
    # 词项从小到大按照字典序排序
    wordsDict = &#123;key: wordsDict[key] for key in sorted(wordsDict)&#125;
    outWordsDict(wordsDict, blockid)
</code></pre>
<ol>
<li>将块记录写回磁盘文件</li>
</ol>
<pre><code class="lang-python"># 将局部索引输出到硬盘上
def outWordsDict(wordsDict, blockid):
    f = open(&quot;target/block&quot; + str(blockid) + &quot;.txt&quot;, &#39;w&#39;, encoding = &#39;utf-8&#39;)
    for key in wordsDict.keys():
        # print(key)
        f.write(key + &#39;\t&#39; + str(wordsDict[key][1]) + &#39;\t&#39; + wordsDict[key][0] + &#39;\n&#39;)
    f.flush()
    f.close()
</code></pre>
<p>分块结果如图，存放在target文件夹下作为索引中间文件</p>
<p><img src="https://morphling-picgo.oss-cn-shanghai.aliyuncs.com/clip_image002.png" alt="img"></p>
<h3 id="合并多个索引块"><a href="#合并多个索引块" class="headerlink" title="合并多个索引块"></a>合并多个索引块</h3><ol>
<li><p>打开所有块索引文件，读取每个块的第一条索引条目，利用堆结构维护条目，以词项为关键字，维护词项字典序最小的条目</p>
</li>
<li><p>从堆中取出词项字典序最小的条目，若对应文件仍未读完，则将对应文件的下一条条目也插入堆中</p>
</li>
<li><p>根据当前取出的条目，在内存中维护当前词项的docList（对Delta编码解压，记录真实docID）</p>
</li>
<li><p>当前词项的所有条目都处理完毕时（堆顶元素的词项的字典序大于当前词项），对docList再次进行Delta编码压缩，并将该倒排索引记录写回磁盘</p>
</li>
<li><p>重复步骤2)、3)、4)，直到每个块索引文件的条目都被处理完毕，即堆元素全部弹出，堆大小为0，此时倒排记录表dict.index.txt生成完毕</p>
</li>
</ol>
<pre><code class="lang-python"># 合并多个索引块，利用堆结构维护
def mergeBlocks(blocknum):
    files = []
    heap = []
    word_now = &#39;&#39;
    df_now = 0
    result_now = []
    f_out = open(&quot;dict.index2.txt&quot;, &#39;w&#39;, encoding = &#39;utf-8&#39;) # 合并索引所在文件
    for i in range(blocknum):
        f = open(&quot;target/block&quot; + str(i + 1) + &quot;.txt&quot;, &#39;r&#39;, encoding = &#39;utf-8&#39;, buffering = 100)
        files.append(f)
        line = f.readline()
        item = line.strip().split(&#39;\t&#39;)
        item.append(i)
        heappush(heap, item)
    while(len(heap) &gt; 0):
        # 取出小根堆顶的索引条目，并继续读取对应的下一个条目
        item_now = heappop(heap)
        doc = item_now[3]
        line = files[doc].readline()
        # 若条目未读完，则将下一个条目放入堆中
        if line:
            item = line.strip().split(&#39;\t&#39;)
            item.append(doc)
            heappush(heap, item)
        if (item_now[0] != word_now):
            # 当前维护的词项与下一条词项不同，说明当前词项已全部读取，将当前词项及索引写回磁盘
            if (word_now != &#39;&#39;):
                # heapify(result_now)
                writeBackFile(f_out, word_now, df_now, result_now)
            word_now = item_now[0]
            df_now = int(item_now[1])
            result_now = []
            # 用另一个堆维护当前词项的文档
            accmulatedDocId = 0
            for docid in item_now[2].split(&#39;,&#39;):
                accmulatedDocId += int(docid)
                heappush(result_now, accmulatedDocId)
        else:
            df_now += int(item_now[1])
            # 用另一个堆维护当前词项的文档
            accmulatedDocId = 0
            for docid in item_now[2].split(&#39;,&#39;):
                # 记录真实docID（累加和）
                accmulatedDocId += int(docid)
                heappush(result_now, accmulatedDocId)
    # 将最后一个条目写回磁盘

    if (word_now != &#39;&#39;):
        writeBackFile(f_out, word_now, df_now, result_now)

def writeBackFile(f_out, word_now, df_now, result_now):
    # 先将result_now一个一个取出，再按照Delta编码增量方式重新压缩
    docList = []
    while(len(result_now) != 0):
        docList.append(heappop(result_now))
    for i in range(len(docList) - 1, 0, -1):
        # print(i)
        docList[i] -= docList[i - 1]
    docstr = &#39;&#39;
    for doc in docList:
        docstr += &#39;,&#39; + str(doc)
    docstr = docstr[1:]
    f_out.write(word_now + &#39;\t&#39; + str(df_now) + &#39;\t&#39; + docstr + &#39;\n&#39;)
</code></pre>
<p>倒排索引记录如图：</p>
<p><img src="https://morphling-picgo.oss-cn-shanghai.aliyuncs.com/clip_image002.png" alt="img"></p>
<p>说明：该合并方法保证了内存中只需要维护一个大小不超过分块个数的堆结构以及当前词项的条目，由于每个分块内的索引都是按词项排序的，所以合并过程中可以只读取每个分块索引最前面的条目，并按照词项字典序从小到大一个一个确定词项条目内容。每确定了一个词项的条目后直接将该条目写回磁盘，不再占用内存空间，这样一来即使最终倒排索引表总大小超过内存限制，在生成倒排表的过程中内存也能容纳所有需要的数据。</p>
<h2 id="布尔查询"><a href="#布尔查询" class="headerlink" title="布尔查询"></a>布尔查询</h2><ol>
<li><p>读取已构建的倒排索引文件dict.index.txt</p>
</li>
<li><p>记录每个词项在文件中对应的条目（即行号）</p>
</li>
</ol>
<pre><code class="lang-python">import linecache
def getLineDict(filename):
    f = open(filename, &#39;r&#39;, encoding=&#39;utf-8&#39;)
    lines = f.readlines()
    lineDict = &#123;&#125;
    # print(len(lines))
    cnt = 0
    for line in lines:
        word, df, res = line.strip().split(&#39;\t&#39;)
        cnt += 1
        lineDict[word] = cnt
    return lineDict
</code></pre>
<ol>
<li><p>读取用户输入，解析布尔查询输入，支持以下三种查询</p>
<ol>
<li>A</li>
<li>A and B</li>
<li>A or B</li>
</ol>
</li>
<li><p>根据输入找到词项对应的行号，在倒排索引文件中读取指定行号，获取每个词项所在的docID列表</p>
<pre><code class="lang-python">def getIndex(lineDict, word):
    if not (word in lineDict):
        return []
    index = []
    line = linecache.getline(&#39;dict.index.txt&#39;, lineDict[word])
    # print(line)
    word, df, res = line.strip().split(&#39;\t&#39;)
    res = res.split(&#39;,&#39;)
    for i in range(len(res)):
        res[i] = int(res[i])
    # 根据压缩后的倒排记录表计算原记录表
    for i in range(1, len(res)):
        res[i] += res[i - 1]
    return res
</code></pre>
</li>
<li><p>将列表转化为集合，通过求集合交集/补集的方式进行布尔运算</p>
</li>
<li><p>输出运算结果，即为查询结果</p>
<pre><code class="lang-python">while(query[0] != &#39;exit()&#39;):
        if (len(query) == 1):
            docListA = getIndex(lineDict, query[0])
            if (len(docListA) == 0):
                print(&#39;no result.&#39;, end=&#39;&#39;)
            for docId in docListA:
                print(docId, end=&#39; &#39;)
            print()
        else:
            docListA = getIndex(lineDict, query[0])
            docListB = getIndex(lineDict, query[2])
            op = query[1]
            if (op == &#39;and&#39;):
                result = set(docListA).intersection(set(docListB))
            else:
                result = set(docListA).union(set(docListB))
            result = sorted(list(result))
            if (len(result) == 0):
                print(&#39;no result.&#39;, end=&#39;&#39;)
            for docId in result:
                print(docId, end=&#39; &#39;)
            print()
        query = input().split(&#39; &#39;)
</code></pre>
</li>
<li><p>重复步骤3、4、5、6，直到用户中止查询</p>
</li>
</ol>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本次实验使用了SPIMI算法实现了倒排索引表构建，构建分块索引时，由于块与块之间独立，使用了多线程的方式提高构建分块索引的效率，同时对记录表采用Delta编码的方式压缩空间大小。合并索引块时，由于每个分块内的索引都是按词项排序的，所以合并过程中内存中可以只存放每个分块索引当前最前面的条目，并用堆结构维护这些条目。每确定了一个词项的条目后直接将该条目写回磁盘，不再占用内存空间，这样一来即使最终倒排索引表总大小超过内存限制，在生成倒排表的过程中内存也能容纳所有需要的数据，因此可以生成任意大小的倒排索引表。</p>
<p>在执行布尔查询读取倒排索引表时，为了避免索引表过大内存无法容纳，并不会直接将整张索引表读入内存，而仅将(词项-行号)信息读入内存，每个词项对应的docID将在解析用户输入后再去读取文件对应的行号来获取。这样一来内存中只需要存放(词项-行号)的信息，以及当前涉及当前查询词项的docList，即可以对任意大小的倒排索引表进行查询。同时，解析所有词项的docID在时间上效率也较低，由于绝大多数与查询不相关的词项docID是不需要解析的，这样的写法也可以避免这些不必要的解析操作。</p>
<p>实验过程中，存在一些参数设置，如每个分块对应的文件个数以及线程池上限，经程序效率测试发现，分块实际上会使程序整体运行效率降低，分块数量越多效率通常越低。</p>
<p><img src="https://morphling-picgo.oss-cn-shanghai.aliyuncs.com/clip_image001.png" alt="img"></p>
<p><img src="https://morphling-picgo.oss-cn-shanghai.aliyuncs.com/clip_image001.png" alt="img"></p>
<p>可能是因为输入数据规模并不是特别大（约50M），无论怎样分块，内存都能够同时容纳所有数据，而分块操作反而增加了一定的IO代价，块数越多则IO代价越大，造成了现在的现象。但对于大规模文本（如100G以上），不进行分块则会由于内存不能够同时容纳全部数据而造成“抖动”现象，对整体执行效率产生较大影响，因此分块的作用可能需要在足够大规模的文本数据集上才能得以体现。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>main.py</p>
<pre><code class="lang-python">import time
from concurrent.futures import ThreadPoolExecutor
import re
from heapq import *
from time import *

# 预处理读入数据
def job(docl, docr, blockid):
    wordsDict = &#123;&#125;
    lastDocId = &#123;&#125;
    stopWords = []
    for docid in range(docl, docr + 1):
        f = open(&quot;data/&quot; + str(docid) + &quot;.txt&quot;, &#39;r&#39;, encoding = &#39;utf-8&#39;)
        lines = f.readlines()
        f.close()
        tempDict = &#123;&#125;
        for line in lines:
            # 按照空格和制表符分割
            words = re.split(&#39;[ \t]&#39;, line.strip())
            for word in words:
                # 去除停用词
                if (word in stopWords): continue
                # 将大写转化为小写
                word = word.lower()
                if (word in tempDict):
                    continue
                tempDict[word] = 1
                if not (word in wordsDict):
                    wordsDict[word] = [str(docid), 1]
                    lastDocId[word] = docid
                else:
                    # 倒排记录表压缩(Delta编码,记录增量)
                    wordsDict[word][0] += &#39;,&#39; + str(docid - lastDocId[word])
                    lastDocId[word] = docid
                    wordsDict[word][1] += 1
                    # df[word] += 1
    # 词项从小到大按照字典序排序
    wordsDict = &#123;key: wordsDict[key] for key in sorted(wordsDict)&#125;
    outWordsDict(wordsDict, blockid)

# 将局部索引输出到硬盘上
def outWordsDict(wordsDict, blockid):
    f = open(&quot;target/block&quot; + str(blockid) + &quot;.txt&quot;, &#39;w&#39;, encoding = &#39;utf-8&#39;)
    for key in wordsDict.keys():
        # print(key)
        f.write(key + &#39;\t&#39; + str(wordsDict[key][1]) + &#39;\t&#39; + wordsDict[key][0] + &#39;\n&#39;)
    f.flush()
    f.close()

# 合并多个索引块，利用堆结构维护
def mergeBlocks(blocknum):
    files = []
    heap = []
    word_now = &#39;&#39;
    df_now = 0
    result_now = []
    f_out = open(&quot;dict.index2.txt&quot;, &#39;w&#39;, encoding = &#39;utf-8&#39;) # 合并索引所在文件
    for i in range(blocknum):
        f = open(&quot;target/block&quot; + str(i + 1) + &quot;.txt&quot;, &#39;r&#39;, encoding = &#39;utf-8&#39;, buffering = 100)
        files.append(f)
        line = f.readline()
        item = line.strip().split(&#39;\t&#39;)
        item.append(i)
        heappush(heap, item)
    while(len(heap) &gt; 0):
        # 取出小根堆顶的索引条目，并继续读取对应的下一个条目
        item_now = heappop(heap)
        doc = item_now[3]
        line = files[doc].readline()
        # 若条目未读完，则将下一个条目放入堆中
        if line:
            item = line.strip().split(&#39;\t&#39;)
            item.append(doc)
            heappush(heap, item)
        if (item_now[0] != word_now):
            # 当前维护的词项与下一条词项不同，说明当前词项已全部读取，将当前词项及索引写回磁盘
            if (word_now != &#39;&#39;):
                # heapify(result_now)
                writeBackFile(f_out, word_now, df_now, result_now)
            word_now = item_now[0]
            df_now = int(item_now[1])
            result_now = []
            # 用另一个堆维护当前词项的文档
            accmulatedDocId = 0
            for docid in item_now[2].split(&#39;,&#39;):
                accmulatedDocId += int(docid)
                heappush(result_now, accmulatedDocId)
        else:
            df_now += int(item_now[1])
            # 用另一个堆维护当前词项的文档
            accmulatedDocId = 0
            for docid in item_now[2].split(&#39;,&#39;):
                # 记录真实docID（累加和）
                accmulatedDocId += int(docid)
                heappush(result_now, accmulatedDocId)
    # 将最后一个条目写回磁盘

    if (word_now != &#39;&#39;):
        writeBackFile(f_out, word_now, df_now, result_now)

def writeBackFile(f_out, word_now, df_now, result_now):
    # 先将result_now一个一个取出，再按照Delta编码增量方式重新压缩
    docList = []
    while(len(result_now) != 0):
        docList.append(heappop(result_now))
    for i in range(len(docList) - 1, 0, -1):
        # print(i)
        docList[i] -= docList[i - 1]
    docstr = &#39;&#39;
    for doc in docList:
        docstr += &#39;,&#39; + str(doc)
    docstr = docstr[1:]
    f_out.write(word_now + &#39;\t&#39; + str(df_now) + &#39;\t&#39; + docstr + &#39;\n&#39;)

if __name__ == &#39;__main__&#39;:
    # 配置线程池参数
    max_worker = 8 # 线程池上线
    filenum = 100000 # 文件总数
    blocksize = 5000 # 每个block的文件数量
    pool = ThreadPoolExecutor(max_workers = max_worker)
    threads = []

    blocknum = (filenum - 1) // blocksize + 1 # 计算总共需要几个block
    begin_time = time()
    print(&quot;max_worker:%d\tFilenum:%d\tBlocksize:%d\tBlocknum:%d&quot; %(max_worker, filenum, blocksize, blocknum))
    print(&quot;开始构建局部索引...&quot;)
    # 将文档分入不同的block
    for i in range(filenum // blocksize):
        thread = pool.submit(job, i * blocksize + 1, i * blocksize + blocksize, i + 1)
        threads.append(thread)

    # 将剩余的文档归入最后一个block
    if filenum % blocksize != 0:
        thread = pool.submit(job, filenum - (filenum % blocksize) + 1, filenum, filenum // blocksize + 1)
        threads.append(thread)

    # 等待线程结束
    for thread in threads:
        thread.result()
    print(&quot;局部索引构建完毕，开始合并局部索引块... (%.4fs)&quot; %(time() - begin_time))
    # 合并所有局部块索引并生成倒排索引
    mergeBlocks(blocknum)
    print(&quot;合并完毕，倒排索引dict.index.txt已生成. (%.4fs)&quot; % (time() - begin_time))
</code></pre>
<p>query.py</p>
<pre><code class="lang-python"># 根据已生成的倒排索引处理布尔查询
# 支持以下三种查询
# 1. A
# 2. A and B
# 3. A or B
import linecache
def getLineDict(filename):
    f = open(filename, &#39;r&#39;, encoding=&#39;utf-8&#39;)
    lines = f.readlines()
    lineDict = &#123;&#125;
    # print(len(lines))
    cnt = 0
    for line in lines:
        word, df, res = line.strip().split(&#39;\t&#39;)
        cnt += 1
        lineDict[word] = cnt
    return lineDict

def getIndex(lineDict, word):
    if not (word in lineDict):
        return []
    index = []
    line = linecache.getline(&#39;dict.index.txt&#39;, lineDict[word])
    # print(line)
    word, df, res = line.strip().split(&#39;\t&#39;)
    res = res.split(&#39;,&#39;)
    for i in range(len(res)):
        res[i] = int(res[i])
    # 根据压缩后的倒排记录表计算原记录表
    for i in range(1, len(res)):
        res[i] += res[i - 1]
    return res

if __name__ == &#39;__main__&#39;:
    lineDict = getLineDict(&#39;dict.index.txt&#39;)
    query = input().split(&#39; &#39;)
    # 输入exit()停止程序，否则不断循环执行询问
    while(query[0] != &#39;exit()&#39;):
        if (len(query) == 1):
            docListA = getIndex(lineDict, query[0])
            if (len(docListA) == 0):
                print(&#39;no result.&#39;, end=&#39;&#39;)
            for docId in docListA:
                print(docId, end=&#39; &#39;)
            print()
        else:
            docListA = getIndex(lineDict, query[0])
            docListB = getIndex(lineDict, query[2])
            op = query[1]
            if (op == &#39;and&#39;):
                result = set(docListA).intersection(set(docListB))
            else:
                result = set(docListA).union(set(docListB))
            result = sorted(list(result))
            if (len(result) == 0):
                print(&#39;no result.&#39;, end=&#39;&#39;)
            for docId in result:
                print(docId, end=&#39; &#39;)
            print()
        query = input().split(&#39; &#39;)
</code></pre>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script> 
<script>
    var gitalk = new Gitalk({
            clientID: 'b8ab854d61e4537d8b06',
            clientSecret: '2557531f91b562289cfc3025675934139fc97766',
            repo: 'gitalk-repo',
            owner: 'liyunfan1223',
            admin: ['liyunfan1223'],
            id: md5(location.pathname),
            // facebook-like distraction free mode
            distractionFreeMode: false
        })
   gitalk.render('gitalk-container')
</script>
</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2021/11/16/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/DMS-mid-term/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2021/10/31/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/Ubuntu20-04-gcc%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91-qemu%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85arm64%E6%9E%B6%E6%9E%84%E7%B3%BB%E7%BB%9F/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/favicon_io/android-chrome-512x512.png" alt="MorphLing's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        liyunfan1223@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2023/03/">三月 2023<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/07/">七月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/06/">六月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/05/">五月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/04/">四月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/03/">三月 2022<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/02/">二月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/01/">一月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/12/">十二月 2021<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/11/">十一月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/10/">十月 2021<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/09/">九月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/08/">八月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/07/">七月 2021<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/06/">六月 2021<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/05/">五月 2021<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/04/">四月 2021<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/03/">三月 2021<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/02/">二月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/01/">一月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/12/">十二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/10/">十月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/08/">八月 2020<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/05/">五月 2020<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/04/">四月 2020<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">博客搭建<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/">算法竞赛<span class="sidebar_archives-count">55</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">课程笔记<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E9%9A%8F%E4%BE%BF%E8%81%8A%E8%81%8A/">随便聊聊<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/">项目总结<span class="sidebar_archives-count">27</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/links" title="友链">
                
                    <i class="material-icons sidebar-material-icons">face</i>
                
                友链
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">cloud_circle</i>
                
                标签云
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

    <a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.help
        <span class="mdl-button__ripple-container">
          <span class="mdl-ripple"></span>
        </span>
      </div>
    </a>

-->

<!-- Feedback -->
<!--

    <a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.feedback
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2020&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Moonglade
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- GitTalk -->





<!-- UC Browser Compatible -->

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->

<script type="text/ls-javascript" id="Bing-Background-script">
    queue.offer(function(){
        $('body').attr('data-original', 'https://api.i-meto.com/bing?type=T');
    });
</script>


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
    
</html>
